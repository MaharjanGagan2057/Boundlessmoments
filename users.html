<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Users</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body>
    <!-- sidebar -->
    <div class="flex">
      <!-- Sidebar -->
      <aside class="fixed top-0 left-0 h-screen w-40 bg-blue-100 p-5">
        <p class="underline text-center font-bold">Admin Panel</p>
        <ul class="mt-5 space-y-2">
          <li>
            <a href="/admin" class="text-blue-600 hover:underline">Dashboard</a>
          </li>
          <li>
            <a href="/users" class="text-blue-600 hover:underline">Users</a>
          </li>
          <li>
            <a href="/employees" class="text-blue-600 hover:underline"
              >Employees</a
            >
          </li>
          <li>
            <a href="/addportfolio" class="text-blue-600 hover:underline"
              >Portfolio</a
            >
          </li>
          <li>
            <a href="/admin/addgallery" class="text-blue-600 hover:underline"
              >Gallery</a
            >
          </li>
          <li>
            <a href="/adminblogs" class="text-blue-600 hover:underline"
              >Blogs</a
            >
          </li>
          <li>
            <a href="/messages" class="text-blue-600 hover:underline"
              >Messages</a
            >
          </li>
        </ul>
        <button
          onclick="window.location.href = '/logout'"
          class="mt-5 w-full text-white bg-red-500 rounded p-2 hover:bg-red-600"
        >
          Logout
        </button>
      </aside>

      <!-- main content-->
      <div class="bg-gray-50 min-h-screen p-6 w-full ml-40">
        <h1 class="text-3xl font-bold mb-6 text-center">Users List</h1>
        <a
          href="/signup"
          class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded shadow"
        >
          Add New User
        </a>
        <br />
        <br />
        <div class="overflow-x-auto shadow-lg rounded-lg">
          <table class="w-full table-auto">
            <thead class="bg-blue-600 text-white">
              <tr>
                <th class="p-3">ID</th>
                <th class="p-3">Username</th>
                <th class="p-3">password</th>
                <th class="p-3">Actions</th>
              </tr>
            </thead>

            <tbody id="userTable" class="bg-white"></tbody>
          </table>
        </div>

        <!-- Fetch users data from server -->
        <script>
          fetch("/users/data")
            .then((res) => res.json())
            .then((users) => {
              const table = document.getElementById("userTable");
              users.forEach((user) => {
                table.innerHTML += `
                <tr class="border-b">
                    <td class="p-3 text-center">${user.id}</td>
                    <td class="p-3 text-center">${user.username}</td>
                    <td class="p-3 text-center">${user.password}</td>
            
                    <td class="p-3 text-center">
                        <button onclick="window.location.href='/users/edit/${user.id}'"
                        class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 mr-2">
                        Edit
                        </button>
                        <button onclick="confirmDelete(${user.id})"
                        class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">
                        Delete
                        </button>
                    </tr>
                    `;
              });
            });

          //confirm  to edit alert js function
          function confirmEdit(id) {
            if (confirm("Do you want to edit this person's details?")) {
              window.location.href = `/users/edit/${id}`;
            }
          }

          //confirm  to delete alert js function
          function confirmDelete(id) {
            // Function to show confirmation dialog
            if (confirm("Are you sure you want to delete this user?")) {
              // Show confirmation dialog
              window.location.href = `/users/delete/${id}`; // Redirect to the delete route
            }
          }
        </script>
      </div>
    </div>
  </body>
</html>
