<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Employees</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-50">
    <!-- Sidebar -->
    <aside class="fixed top-0 left-0 h-screen w-40 bg-blue-100 p-5">
      <p class="underline text-center font-bold">Admin Panel</p>
      <ul class="mt-5 space-y-2">
        <li>
          <a href="/admin" class="text-blue-600 hover:underline">Dashboard</a>
        </li>
        <li>
          <a href="/users" class="text-blue-600 hover:underline">Users</a>
        </li>
        <li>
          <a href="/employees" class="text-blue-600 hover:underline"
            >Employees</a
          >
        </li>
        <li>
          <a href="/addportfolio" class="text-blue-600 hover:underline"
            >Portfolio</a
          >
        </li>
        <li>
          <a href="/admin/addgallery" class="text-blue-600 hover:underline"
            >Gallery</a
          >
        </li>
        <li>
          <a href="/adminblogs" class="text-blue-600 hover:underline">Blogs</a>
        </li>
        <li>
          <a href="/messages" class="text-blue-600 hover:underline">Messages</a>
        </li>
      </ul>
      <button
        onclick="window.location.href = '/logout'"
        class="mt-5 w-full text-white bg-red-500 rounded p-2 hover:bg-red-600"
      >
        Logout
      </button>
    </aside>

    <!-- Main content -->
    <main class="ml-40 p-6 min-h-screen">
      <h1 class="text-3xl font-bold mb-4 text-center">Employees List</h1>

      <div class="flex justify-end mb-4">
        <button
          onclick="window.location.href = '/employees/add'"
          class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600"
        >
          Add Employee
        </button>
      </div>

      <div class="overflow-x-auto shadow-lg rounded-lg">
        <table class="min-w-full text-center table-auto">
          <thead class="bg-blue-600 text-white">
            <tr>
              <th class="p-3">ID</th>
              <th class="p-3">Name</th>
              <th class="p-3">Position</th>
              <th class="p-3">Salary</th>
              <th class="p-3">Department</th>
              <th class="p-3">Actions</th>
            </tr>
          </thead>
          <tbody id="employeeTable" class="bg-white"></tbody>
        </table>
      </div>
    </main>

    <script>
      // Fetch employees data dynamically
      fetch("/employees/data")
        .then((res) => res.json())
        .then((data) => {
          const table = document.getElementById("employeeTable");
          table.innerHTML = ""; // clear table first
          data.forEach((emp) => {
            table.innerHTML += `
            <tr class="border-b">
              <td class="p-3">${emp.id}</td>
              <td class="p-3">${emp.name}</td>
              <td class="p-3">${emp.position}</td>
              <td class="p-3">${emp.salary}</td>
              <td class="p-3">${emp.department}</td>
              <td class="p-3">
                <button onclick="confirmEdit(${emp.id})"
                        class="bg-blue-600 text-white px-3 py-1 rounded mr-2 hover:bg-blue-700">
                  Edit
                </button>
                <button onclick="confirmDelete(${emp.id})"
                        class="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700">
                  Delete
                </button>
              </td>
            </tr>
          `;
          });
        })
        .catch((err) => console.error("Error fetching employees:", err));

      // Confirm Edit
      function confirmEdit(id) {
        if (confirm("Do you want to edit this employee?")) {
          window.location.href = `/employees/edit/${id}`;
        }
      }

      // Confirm Delete
      function confirmDelete(id) {
        if (confirm("Are you sure you want to delete this employee?")) {
          window.location.href = `/employees/delete/${id}`;
        }
      }
    </script>
  </body>
</html>
